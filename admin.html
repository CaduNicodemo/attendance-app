<h2>Usu√°rios pendentes</h2>
<ul id="pendingList"></ul>

<script type="module">
import { db } from "./config.js";
import { getDocs, collection, updateDoc, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

async function loadPending() {
  const list = document.getElementById("pendingList");
  list.innerHTML = "";

  const snap = await getDocs(collection(db, "users"));
  snap.forEach(userDoc => {
    const data = userDoc.data();
    if (data.role === "pending") {
      const li = document.createElement("li");
      li.textContent = `${data.name} (${data.email}) `;
      const approveBtn = document.createElement("button");
      approveBtn.textContent = "Aprovar";
      approveBtn.onclick = async () => {
        await updateDoc(doc(db, "users", userDoc.id), { role: "user" });
        loadPending();
      };
      const rejectBtn = document.createElement("button");
      rejectBtn.textContent = "Rejeitar";
      rejectBtn.onclick = async () => {
        await deleteDoc(doc(db, "users", userDoc.id));
        loadPending();
      };
      li.append(approveBtn, rejectBtn);
      list.appendChild(li);
    }
  });
}

loadPending();
</script>
